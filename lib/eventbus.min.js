(function(_1,_2){if(typeof exports==="object"&&typeof module==="object"){module.exports=_2();}else{if(typeof define==="function"&&define.amd){define("EventBus",[],_2);}else{if(typeof exports==="object"){exports["EventBus"]=_2();}else{_1["EventBus"]=_2();}}}})(this,function(){function _3(_4,_5){_4=_4||[];var _6={stop:function(_7){this.isStopped=true;this.result=_7;}};for(var i in _4){_5(i,_4[i],_4,_6);if(_6.isStopped){break;}}if(_6.isStopped){return _6.result;}};function _8(_9,_a,_b){if(_a>_9.length){return [];}return [].slice.call(_9,_a==undefined?0:_a,_b==undefined?_9.length:_b)||[];};function _c(_d,_e,_f){if(typeof _d=="string"||_d instanceof Array){var _10=_d;if(typeof _d=="string"){_10=_d.trim().split(/\s|,/);}if(_10.length>1){var _11=this;_3(_10,function(_12,_13){_f[0]=_13;_e.apply(_11,_f);});return _11;}else{_d=_10[0];}}return _d;};var _14={};_14=function(){this.listeners={};this.regexListeners=[];};_14.prototype={on:function(_15,_16,_17){_15=_c.call(this,_15,this.on,_8(arguments));if(_15==this){return this;}var _18=_15 instanceof RegExp;var _19=_18?_15.toString():_15;var _1a=_8(arguments);var _1b={scope:_17||{},callback:_16,args:_1a,regExp:_15,eventType:_19};if(!_18){if(typeof this.listeners[_19]!="undefined"){this.listeners[_19].push(_1b);}else{this.listeners[_19]=[_1b];}}else{this.regexListeners.push(_1b);}return this;},once:function(_1c,_1d,_1e){var bus=this;var _1f=function(_20){_1d.apply(this,_8(arguments));bus.off(_1c,_1f,_1e);};var _21=_8(arguments);_21[1]=_1f;return bus.on.apply(bus,_21);},off:function(_22,_23,_24){_22=_c.call(this,_22,this.off,[undefined,_23,_24]);if(_22==this){return this;}var _25=_22 instanceof RegExp;var _26=_25?_22.toString():_22;var _27=[];if(typeof _23=="object"){_24=_23;_23=undefined;}var _28=_23==undefined;var _29=_24==undefined;function _2a(_2b){return (_28?true:_2b.callback==_23)&&(_29?true:_2b.scope==_24);};if(!_25){if(typeof this.listeners[_26]!="undefined"){if(!(_28&&_29)){_3(this.listeners[_26],function(i,_2c){if(!_2a(_2c)){_27.push(_2c);}else{}});}this.listeners[_26]=_27;}}else{_3(this.regexListeners,function(_2d,_2e){if(!(_2e.eventType==_26&&_2a(_2e))){_27.push(_2e);}else{}});this.regexListeners=_27;}return this;},has:function(_2f,_30,_31){var _32=_2f instanceof RegExp;var _33=_32?_2f.toString():_2f;var _34=[].concat(this.listeners[_33]);if(typeof _30=="object"){_31=_30;_30=undefined;}if(_34.length>0&&!_32){var _35=_34.length;if(_30===undefined&&_31===undefined){return _35>0;}var _36=_3(_34,function(_37,_38,_39,_3a){if((_31?_38.scope==_31:true)&&(_30?_38.callback==_30:true)){_3a.stop(true);}});if(_36){return true;}}else{if(_32){_34=[].concat(this.regexListeners);var _36=_3(_34,function(_3b,_3c,_3d,_3e){if(_3c.regExp.toString()==_33&&(_31?_3c.scope==_31:true)&&(_30?_3c.callback==_30:true)){_3e.stop(true);}});if(_36){return true;}}}return false;},emit:function(_3f){var _40=_8(arguments);_3f=_c.call(this,_3f,this.emit,_40);if(_3f==this){return this;}var _41={type:_3f,target:_40.length>1?_40[1]:{}};_40=[_41].concat(_8(arguments,1));var _42=[].concat(typeof this.listeners[_3f]=="undefined"?[]:this.listeners[_3f]);function _43(_44){var _45=false;_41.stop=function(){_45=true;};_41.getArg=function(_46){if(_41.args==undefined||!_41.args instanceof Array||_41.args.length-1<_46){return undefined;}return _41.args[_46];};_3(_44,function(_47,_48,_49,_4a){if(_48&&_48.callback){var _4b=[].concat(_40);_41.args=[].concat(_48.args);_48.callback.apply(_48.scope,_4b);if(_45){_4a.stop();}}});};var _4c=[].concat(this.regexListeners);_3(_4c,function(i,_4d){if(_4d.regExp.test(_3f)){_42.push(_4d);}});_43(_42);return this;},getEvents:function(){var str="";for(var _4e in this.listeners){var _4f=this.listeners[_4e].length;for(var i=0;i<_4f;i++){var _50=this.listeners[_4e][i];str+=_50.scope&&_50.scope.className?_50.scope.className:"anonymous";str+=" listen for '"+_4e+"'\n";}}_3([].concat(this.regexListeners),function(_51,_52){str+=_52.scope&&_52.scope.className?_52.scope.className:"anonymous";str+=" listen for '"+_52.eventType+"'\n";});return str;}};_14.prototype.bind=_14.prototype.addEventListener=_14.prototype.on;_14.prototype.unbind=_14.prototype.removeEventListener=_14.prototype.off;_14.prototype.trigger=_14.prototype.dispatch=_14.prototype.emit;_14.prototype.hasEventListener=_14.prototype.has;var _53=new _14();return _53;});