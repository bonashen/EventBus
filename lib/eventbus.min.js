(function(_1,_2){if(typeof exports==="object"&&typeof module==="object"){module.exports=_2();}else{if(typeof define==="function"&&define.amd){define("EventBus",[],_2);}else{if(typeof exports==="object"){exports["EventBus"]=_2();}else{_1["EventBus"]=_2();}}}})(this,function(){function _3(_4,_5){_4=_4||[];var _6={stop:function(_7){this.isStopped=true;this.result=_7;}};for(var i in _4){_5(i,_4[i],_4,_6);if(_6.isStopped){break;}}if(_6.isStopped){return _6.result;}};function _8(_9,_a,_b){if(_a>_9.length){return [];}return [].slice.call(_9,_a==undefined?0:_a,_b==undefined?_9.length:_b)||[];};function _c(_d,_e,_f){if(typeof _d=="string"||_d instanceof Array){var _10=_d;if(typeof _d=="string"){_10=_d.trim().split(/\s|,/);}if(_10.length>1){var _11=this;_3(_10,function(_12,_13){_f[0]=_13;_e.apply(_11,_f);});return _11;}else{_d=_10[0];}}return _d;};var _14={};_14=function(){this.listeners={};this.regexListeners=[];};_14.prototype={on:function(_15,_16,_17){_15=_c.call(this,_15,this.on,_8(arguments));if(_15==this){return this;}var _18=_15 instanceof RegExp;var _19=_18?_15.toString():_15;var _1a=_8(arguments,3);var _1b={scope:_17||{},callback:_16,args:_1a,regExp:_15,eventType:_19};if(!_18){if(typeof this.listeners[_19]!="undefined"){this.listeners[_19].push(_1b);}else{this.listeners[_19]=[_1b];}}else{this.regexListeners.push(_1b);}return this;},once:function(_1c,_1d,_1e){var bus=this;var _1f=function(_20){_1d.apply(this,_8(arguments));bus.off(_1c,_1f,_1e);};return bus.on(_1c,_1f,_1e);},off:function(_21,_22,_23){_21=_c.call(this,_21,this.off,[undefined,_22,_23]);if(_21==this){return this;}var _24=_21 instanceof RegExp;var _25=_24?_21.toString():_21;var _26=[];if(typeof _22=="object"){_23=_22;_22=undefined;}var _27=_22==undefined;var _28=_23==undefined;function _29(_2a){return (_27?true:_2a.callback==_22)&&(_28?true:_2a.scope==_23);};if(!_24){if(typeof this.listeners[_25]!="undefined"){if(!(_27&&_28)){_3(this.listeners[_25],function(i,_2b){if(!_29(_2b)){_26.push(_2b);}else{}});}this.listeners[_25]=_26;}}else{_3(this.regexListeners,function(_2c,_2d){if(!(_2d.eventType==_25&&_29(_2d))){_26.push(_2d);}else{}});this.regexListeners=_26;}return this;},has:function(_2e,_2f,_30){var _31=_2e instanceof RegExp;var _32=_31?_2e.toString():_2e;var _33=[].concat(this.listeners[_32]);if(typeof _2f=="object"){_30=_2f;_2f=undefined;}if(_33.length>0&&!_31){var _34=_33.length;if(_2f===undefined&&_30===undefined){return _34>0;}var _35=_3(_33,function(_36,_37,_38,_39){if((_30?_37.scope==_30:true)&&(_2f?_37.callback==_2f:true)){_39.stop(true);}});if(_35){return true;}}else{if(_31){_33=[].concat(this.regexListeners);var _35=_3(_33,function(_3a,_3b,_3c,_3d){if(_3b.regExp.toString()==_32&&(_30?_3b.scope==_30:true)&&(_2f?_3b.callback==_2f:true)){_3d.stop(true);}});if(_35){return true;}}}return false;},emit:function(_3e){var _3f=_8(arguments);_3e=_c.call(this,_3e,this.emit,_3f);if(_3e==this){return this;}var _40={type:_3e,target:_3f.length>1?_3f[1]:{}};_3f=[_40].concat(_8(arguments,1));var _41=[].concat(typeof this.listeners[_3e]=="undefined"?[]:this.listeners[_3e]);function _42(_43){var _44=false;_40.stop=function(){_44=true;};_3(_43,function(_45,_46,_47,_48){if(_46&&_46.callback){var _49=[].concat(_3f);_40.args=[].concat(_46.args);_46.callback.apply(_46.scope,_49);if(_44){_48.stop();}}});};var _4a=[].concat(this.regexListeners);_3(_4a,function(i,_4b){if(_4b.regExp.test(_3e)){_41.push(_4b);}});_42(_41);return this;},getEvents:function(){var str="";for(var _4c in this.listeners){var _4d=this.listeners[_4c].length;for(var i=0;i<_4d;i++){var _4e=this.listeners[_4c][i];str+=_4e.scope&&_4e.scope.className?_4e.scope.className:"anonymous";str+=" listen for '"+_4c+"'\n";}}_3([].concat(this.regexListeners),function(_4f,_50){str+=_50.scope&&_50.scope.className?_50.scope.className:"anonymous";str+=" listen for '"+_50.eventType+"'\n";});return str;}};_14.prototype.bind=_14.prototype.addEventListener=_14.prototype.on;_14.prototype.unbind=_14.prototype.removeEventListener=_14.prototype.off;_14.prototype.trigger=_14.prototype.dispatch=_14.prototype.emit;_14.prototype.hasEventListener=_14.prototype.has;var _51=new _14();return _51;});